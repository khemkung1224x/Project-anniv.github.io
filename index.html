<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>For You üíó</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&family=DM+Serif+Display:ital@0;1&family=Mali:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --pink:#ff7eb6; --pink-soft:#ffd7e8; --ink:#222; --ink-soft:#555;
      --bg:#ffffff; --radius:22px; --shadow:0 10px 30px rgba(255,126,182,.15);
    }

    body{ margin:0; font-family:"DM Sans", system-ui; background:var(--bg); color:var(--ink); }
    body.no-scroll{ overflow:hidden; }

    .container{width:min(1100px,92vw);margin:0 auto;}
    section{padding:64px 0}
    .card{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);}
    .headline{font-family:"DM Serif Display",serif;font-size:clamp(40px,6vw,76px);margin:0;}
    .sub{color:var(--ink-soft);font-size:clamp(16px,2.2vw,20px);margin-top:12px}
    .thai-letter{ font-family: "Mali", cursive, "DM Sans", sans-serif; }

    /* Top love timer */
    .love-timer{ position:relative; padding:16px 0 0; background: linear-gradient(180deg, #fff7fc 0%, #ffffff 70%); }
    .timer-pill{
      --timer-size: clamp(22px, 5.5vw, 46px);
      display:flex; justify-content:center; align-items:center; text-align:center;
      gap:10px; padding:14px 20px;
      background:#fff; border:2px solid var(--pink-soft); border-radius:999px;
      box-shadow: var(--shadow);
      width:fit-content; margin:0 auto 14px auto;
      white-space: nowrap; flex-wrap: nowrap; max-width:100%; overflow:hidden;
    }
    #loveCounterTop{
      font-family: "Mali", cursive, "DM Sans", sans-serif;
      font-weight: 600; font-size: var(--timer-size); line-height: 1.15;
      color: var(--pink); letter-spacing:.3px; font-variant-numeric: tabular-nums;
      -moz-font-feature-settings:"tnum"; -webkit-font-feature-settings:"tnum"; font-feature-settings:"tnum";
      white-space: nowrap; display:inline-block;
    }
    .timer-heart{ font-size: var(--timer-size); animation: beat 1.2s ease-in-out infinite; transform-origin:center; flex:0 0 auto; }
    @keyframes beat{ 0%,100%{transform:scale(1)} 25%{transform:scale(1.12)} 50%{transform:scale(.98)} 75%{transform:scale(1.08)} }

    /* Intro overlay: 3-2-1 + message */
    .intro{ position:fixed; inset:0; background:#fff; z-index:10000; display:flex; flex-direction:column; align-items:center; justify-content:center;
      transition:opacity .6s ease, visibility .6s ease; }
    .intro.hidden{ opacity:0; visibility:hidden; }
    .count{ font-family:"DM Serif Display",serif; font-size:clamp(64px,12vw,140px); color:var(--pink); line-height:1; opacity:0; transform:scale(.8); }
    .count.pop{ animation:popIn .7s ease both; }
    @keyframes popIn{ 0%{opacity:0; transform:scale(.8)} 60%{opacity:1; transform:scale(1.06)} 100%{opacity:1; transform:scale(1)} }
    .intro-msg{ margin-top:18px; font-size:clamp(16px,2.2vw,22px); color:var(--ink-soft); opacity:0; transform:translateY(8px);
      transition:opacity .5s ease, transform .5s ease; text-align:center; padding:0 18px; }
    .intro-msg.visible{ opacity:1; transform:none; }
    .intro-hint{ position:absolute; bottom:22px; font-size:12px; color:#999; opacity:.8; }

    /* Hero */
    .hero{position:relative; padding:64px 0 80px; overflow:hidden;}
    .hero-card{display:grid; grid-template-columns:1.2fr .8fr; gap:24px; align-items:center}
    .hero-photo{position:relative; border-radius:var(--radius); overflow:hidden; aspect-ratio:16/10;}
    .hero-photo img{width:100%; height:100%; object-fit:cover;}
    .hero-badge{position:absolute; top:16px; left:16px; background:rgba(255,255,255,.85); color:var(--pink); padding:8px 12px; border-radius:999px; font-weight:700; box-shadow:var(--shadow)}

    /* Floating hearts */
    .float-hearts{position:absolute; inset:0; pointer-events:none; overflow:hidden}
    .heart{position:absolute; width:18px; height:18px; background:var(--pink); transform:rotate(45deg); opacity:.18; animation:floatUp linear infinite; border-radius:2px}
    .heart:before,.heart:after{content:""; position:absolute; width:18px; height:18px; background:var(--pink); border-radius:50%}
    .heart:before{left:-9px} .heart:after{top:-9px}
    @keyframes floatUp{0%{transform:translateY(12px) rotate(45deg);opacity:.15}100%{transform:translateY(-120vh) rotate(45deg);opacity:0}}

    /* Slider with center focus */
    .slider{ display:flex; gap:14px; overflow-x:auto; scroll-snap-type:x mandatory; padding:40px 0; scroll-behavior:smooth; }
    .slider::-webkit-scrollbar{display:none;}
    .slide{ flex:0 0 70%; max-width:800px; aspect-ratio:4/3; border-radius:16px; overflow:hidden; background:#fff; box-shadow:var(--shadow);
      scroll-snap-align:center; transition:transform .4s ease, opacity .4s ease; }
    .slide img{width:100%;height:100%;object-fit:cover;}
    .slide:not(.active){ transform:scale(0.85); opacity:0.5; }
    .slide.active{ transform:scale(1); opacity:1; box-shadow:0 15px 35px rgba(255,126,182,.4); }
    @media(max-width:640px){ .slide{flex:0 0 85%;} }

    /* Dots */
    .dots{ display:flex; gap:8px; justify-content:center; margin:10px 0 0; }
    .dot{ width:8px; height:8px; border-radius:999px; background:#ffd7e8; border:none; padding:0; cursor:pointer; }
    .dot.active{ background:var(--pink); transform:scale(1.4); transition:transform .2s ease, background .2s ease; }

    /* Letter */
    .letter{padding:28px; border:2px solid var(--pink-soft); border-radius:22px;}
    .letter h2{font-family:"DM Serif Display",serif;font-size:32px;margin:0 0 12px}
    .letter p{margin:0 0 14px}

    /* Gate (container) */
    .gate{display:flex;flex-direction:column;align-items:center;padding:40px;background:#fff;border:2px dashed var(--pink-soft);border-radius:22px;text-align:center;}
    .gate h3{margin:0 0 20px;font-size:24px}

    /* === New PIN pad styles === */
    #pinDots{ display:flex; gap:14px; justify-content:center; margin-bottom:18px; }
    #pinDots .dot{
      width:18px; height:18px; border-radius:50%;
      border:2px solid var(--pink-soft); background:#fff; transition:.2s;
    }
    #pinDots .dot.filled{ background:var(--pink); }

    .numpad{
      display:grid; grid-template-columns:repeat(3,72px);
      gap:18px; justify-content:center; margin-bottom:12px;
    }
    .numpad button{
      width:72px; height:72px; border-radius:50%;
      background:rgba(255,255,255,0.25);
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
      border:2px solid rgba(255,126,182,0.3);
      color:#ff4f9f; font-size:20px; font-weight:700; cursor:pointer;
      box-shadow:0 6px 16px rgba(255,126,182,.2); transition:.15s;
    }
    .numpad button:hover{ background:rgba(255,126,182,.18); }
    .numpad button:active{ transform:scale(.9); }
    .numpad .clear{ color:#555; }
    .numpad .enter{ color:#19a974; }
    .numpad .zero{ grid-column:2; }

    .btn{background:var(--pink);color:#fff;border:0;padding:12px 24px;border-radius:999px;font-weight:700;cursor:pointer;box-shadow:0 8px 20px rgba(255,126,182,.35);}
    .status{margin-top:12px;font-weight:700;}
    .status.ok{color:#19a974} .status.err{color:#e74c3c}

    /* Confetti canvas overlay */
    #confetti { position: fixed; inset: 0; pointer-events: none; width: 100vw; height: 100vh; z-index: 9999; }

    /* shake ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î */
    @keyframes shake{
      0%,100%{transform:translateX(0)}
      20%{transform:translateX(-6px)}
      40%{transform:translateX(6px)}
      60%{transform:translateX(-4px)}
      80%{transform:translateX(4px)}
    }
    .shake{ animation:shake .4s; }
  </style>
</head>
<body class="no-scroll">
  <!-- Top love timer -->
  <div class="love-timer">
    <div class="container">
      <div class="timer-pill thai-letter" id="timerPill">
        <span id="loveCounterTop" aria-live="polite">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‚Ä¶</span>
        <span class="timer-heart" id="timerHeart" aria-hidden="true">üíó</span>
      </div>
    </div>
  </div>

  <!-- Intro Overlay -->
  <div class="intro" id="intro" aria-live="polite">
    <div class="count" id="introCount" aria-hidden="true">3</div>
    <div class="intro-msg thai-letter" id="introMsg">‡∏Ñ‡∏£‡∏ö 1 ‡∏õ‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ô‡πâ‡∏≤‡∏≤üíó</div>
    <div class="intro-hint thai-letter">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‚Ä¶</div>
  </div>

  <header class="hero">
    <div class="container">
      <div class="hero-card">
        <div>
          <h1 class="headline">Happy 1st Anniversary üíû</h1>
          <p class="sub thai-letter" style="max-width:48ch">
            ‡∏ñ‡πâ‡∏≤‡πÄ‡∏ò‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏£‡∏ö 1 ‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏Ñ‡∏ö‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‡πÄ‡∏¢‡πâ‡πÜ‡πÜüéâ 365 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏Ñ‡∏ö‡∏Å‡∏±‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡πÅ‡∏õ‡∏õ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏ô‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ô‡∏∞ ‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡πâ‡∏≤‡πÑ‡∏õ‡∏ô‡∏≤‡∏ô‡πÜ‡πÄ‡∏•‡∏¢‡∏ô‡πâ‡∏≤‡∏≤ü§ç
          </p>
        </div>
        <div class="hero-photo card">
          <img loading="lazy" decoding="async" src="assets/hero.jpg" alt="Us, smiling together">
          <div class="hero-badge">1 year with you ‚úø</div>
        </div>
      </div>
    </div>
    <div class="float-hearts" id="hearts"></div>
  </header>

  <main>
    <!-- Gallery -->
    <section id="photos">
      <div class="container">
        <h2 class="headline">Snapshots I love</h2>
        <p class="sub thai-letter">‡∏õ‡∏µ‡πÅ‡∏£‡∏Å‡∏£‡∏π‡∏õ‡∏Ñ‡∏π‡πà‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏¢‡∏≠‡∏∞‡πÅ‡∏ï‡πà‡∏õ‡∏µ‡∏ï‡πà‡∏≠‡πÜ‡πÑ‡∏õ‡∏Å‡πá‡∏°‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ‡πÄ‡∏•‡∏¢‡∏ô‡πâ‡∏≤‡∏≤‡∏≤‚ú®</p>

        <div class="slider" id="photoSlider">
          <div class="slide"><img loading="lazy" decoding="async" src="assets/photo1.jpg" alt="Memory 1"></div>
          <div class="slide"><img loading="lazy" decoding="async" src="assets/photo2.jpg" alt="Memory 2"></div>
          <div class="slide"><img loading="lazy" decoding="async" src="assets/photo3.jpg" alt="Memory 3"></div>
          <div class="slide"><img loading="lazy" decoding="async" src="assets/photo4.jpg" alt="Memory 4"></div>
          <div class="slide"><img loading="lazy" decoding="async" src="assets/photo5.jpg" alt="Memory 5"></div>
          <div class="slide"><img loading="lazy" decoding="async" src="assets/photo6.jpg" alt="Memory 6"></div>
        </div>

        <!-- pagination dots -->
        <div class="dots" id="dots" aria-label="Slide pagination"></div>
      </div>
    </section>

    <!-- Letter -->
    <section id="letter">
      <div class="container">
        <div class="letter thai-letter">
          <h2>My little note to you</h2>
          <p>To ‡∏û‡∏¥‡∏ä‡∏ì‡∏≤‡∏ì‡∏¥‡∏ô‡∏ò‡πå,</p>
          <p>‡∏õ‡∏µ 1 ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏±‡∏ô‡∏ö‡πâ‡∏≤‡∏á‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ò‡∏≠‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ô‡∏∞ ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏¢‡∏≠‡∏∞‡πÑ‡∏õ‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏û‡∏∂‡πà‡∏á‡∏£‡∏≥‡∏Ñ‡∏≤‡∏ç‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏•‡∏¢‡∏ô‡∏∞TT ‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏≠‡∏ô‡πÄ‡∏Ñ‡πâ‡∏≤‡πÑ‡∏õ‡∏ô‡∏≤‡∏ô‡πÜ‡∏≠‡∏¢‡πà‡∏≤‡∏û‡∏∂‡πà‡∏á‡πÑ‡∏õ‡πÑ‡∏´‡∏ô‡∏ô‡πâ‡∏≤‡∏≤ ‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏ó‡∏µ‡πà‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ó‡∏≥‡∏ï‡∏±‡∏ß‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡πÉ‡∏™‡πà‡πÄ‡∏ò‡∏≠ ‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏ó‡∏µ‡πà‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πÄ‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏ò‡∏≠ ‡∏ñ‡∏∂‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏û‡∏π‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πà‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏ô‡∏±‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà ‡πÅ‡∏ï‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ‡∏ß‡∏±‡∏ô ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡∏°‡∏≤‡∏Å‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡πâ‡∏≤‡πÑ‡∏õ‡∏ô‡∏≤‡∏ô‡πÜ‡∏ô‡∏∞ü§ç</p>
          <p>‚Äî ‡∏û‡∏µ‡∏£‡∏±‡∏ä‡∏ä‡∏±‡∏¢ üíå</p>
        </div>
      </div>
    </section>

    <!-- Secret Code (PIN pad) -->
    <section id="secret">
      <div class="container">
        <div class="gate thai-letter">
          <h3>Enter our secret code</h3>

          <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å -->
          <div class="otp-wrap" id="pinDots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
          </div>

          <!-- ‡πÅ‡∏õ‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏ö‡∏ö‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÉ‡∏™ -->
          <div class="numpad">
            <button type="button" data-num="1">1</button>
            <button type="button" data-num="2">2</button>
            <button type="button" data-num="3">3</button>
            <button type="button" data-num="4">4</button>
            <button type="button" data-num="5">5</button>
            <button type="button" data-num="6">6</button>
            <button type="button" data-num="7">7</button>
            <button type="button" data-num="8">8</button>
            <button type="button" data-num="9">9</button>
            <button type="button" class="clear">‚å´</button>
            <button type="button" data-num="0" class="zero">0</button>
            <button type="button" class="enter">‚úî</button>
          </div>

          <div id="gateStatus" class="status" aria-live="polite"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Confetti overlay -->
  <canvas id="confetti"></canvas>

  <script>
    const CONFIG={CODE:"3967",REDIRECT:true,NEXT_URL:"next.html"};

    /* ----- Intro: 3-2-1 + message ----- */
    (function(){
      const overlay = document.getElementById('intro');
      const countEl = document.getElementById('introCount');
      const msgEl   = document.getElementById('introMsg');

      const seq = ["3","2","1"];
      let i = 0;

      function pop(){
        if(i < seq.length){
          countEl.textContent = seq[i++];
          countEl.classList.remove('pop');
          void countEl.offsetWidth;
          countEl.classList.add('pop');
          setTimeout(pop, 1200);
        }else{
          countEl.style.display = 'none';
          msgEl.classList.add('visible');
          setTimeout(()=>{
            overlay.classList.add('hidden');
            document.body.classList.remove('no-scroll');
          }, 3000);
        }
      }
      if(document.readyState === "loading"){
        document.addEventListener("DOMContentLoaded", pop);
      }else{
        pop();
      }
    })();

    /* üíó Live "time together" counter + auto-fit to one line */
    (function(){
      const LOVE_START = '2024-09-03T00:00:00+07:00'; // edit to real start date
      const textEl = document.getElementById('loveCounterTop');
      const pill   = document.getElementById('timerPill');
      const heart  = document.getElementById('timerHeart');
      const container = pill.parentElement;

      if(!textEl || !pill || !heart) return;

      function pad2(n){ return String(n).padStart(2,'0'); }
      function daysInMonth(y,m){ return new Date(y, m+1, 0).getDate(); }
      function diffYMDHMS(from, to){
        let y = to.getFullYear() - from.getFullYear();
        let m = to.getMonth() - from.getMonth();
        let d = to.getDate() - from.getDate();
        let hh = to.getHours() - from.getHours();
        let mm = to.getMinutes() - from.getMinutes();
        let ss = to.getSeconds() - from.getSeconds();
        if (ss < 0){ ss += 60; mm--; }
        if (mm < 0){ mm += 60; hh--; }
        if (hh < 0){ hh += 24; d--; }
        if (d < 0){
          const y2 = to.getFullYear();
          const m2 = to.getMonth() - 1;
          const dim = daysInMonth(y2, (m2+12)%12);
          d += dim; m--;
        }
        if (m < 0){ m += 12; y--; }
        return {y,m,d,hh,mm,ss};
      }

      const START = new Date(LOVE_START);

      function updateText(){
        const now = new Date();
        const {y,m,d,hh,mm,ss} = diffYMDHMS(START, now);
        textEl.textContent = `‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏°‡∏≤ ${y} ‡∏õ‡∏µ ${m} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${d} ‡∏ß‡∏±‡∏ô ${pad2(hh)}:${pad2(mm)}:${pad2(ss)} ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡πâ‡∏≤‡∏≤`;
      }

      function fitFont(){
        const PADDING_X = 40;
        const GAP = 10;
        const maxW = container.clientWidth - 8;

        let lo = 14, hi = 64, best = 14;
        for(let k=0;k<10;k++){
          const mid = (lo + hi) / 2;
          pill.style.setProperty('--timer-size', mid + 'px');
          const total = textEl.scrollWidth + GAP + heart.offsetWidth + PADDING_X;
          if (total <= maxW){ best = mid; lo = mid; } else { hi = mid; }
        }
        pill.style.setProperty('--timer-size', Math.max(14, Math.min(best, 64)) + 'px');
      }

      function tick(){
        updateText();
        requestAnimationFrame(()=> requestAnimationFrame(fitFont));
      }

      tick();
      setInterval(tick, 1000);

      const ro = new ResizeObserver(()=> fitFont());
      ro.observe(document.documentElement);
      ro.observe(container);
    })();

    /* Floating hearts */
    const heartsEl=document.getElementById('hearts');
    const rand=(min,max)=>Math.random()*(max-min)+min;
    function spawnHeart(){
      const h=document.createElement('div');
      h.className='heart';
      h.style.left=rand(0,100)+'vw';
      h.style.bottom='-20px';
      const dur=rand(8,14);
      h.style.animationDuration=dur+'s';
      heartsEl.appendChild(h);
      setTimeout(()=>h.remove(),dur*1000);
    }
    setInterval(spawnHeart,1200);
    for(let i=0;i<8;i++) setTimeout(spawnHeart,i*250);

    /* Confetti (‡∏´‡∏±‡∏ß‡πÉ‡∏à & ‡∏î‡∏≤‡∏ß) ‚Äî ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å */
    const confettiCanvas = document.getElementById('confetti');
    const ctx = confettiCanvas.getContext('2d');
    function resizeConfetti(){ confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight; }
    addEventListener('resize', resizeConfetti); resizeConfetti();

    function drawStar(cx, cy, spikes, outerR, innerR, rot=0){
      let x=cx, y=cy; ctx.beginPath(); ctx.moveTo(cx, cy - outerR);
      const step = Math.PI / spikes;
      for(let i=0;i<spikes*2;i++){
        const r = i%2===0 ? outerR : innerR;
        const angle = i*step - Math.PI/2 + rot;
        x = cx + Math.cos(angle)*r; y = cy + Math.sin(angle)*r;
        ctx.lineTo(x,y);
      }
      ctx.closePath(); ctx.fill();
    }
    function drawHeart(cx, cy, size, rot=0){
      const s = size;
      ctx.save(); ctx.translate(cx, cy); ctx.rotate(rot);
      ctx.beginPath();
      ctx.moveTo(0, -0.25*s);
      ctx.bezierCurveTo(0.5*s, -0.75*s, 1.1*s, 0.1*s, 0, 0.9*s);
      ctx.bezierCurveTo(-1.1*s, 0.1*s, -0.5*s, -0.75*s, 0, -0.25*s);
      ctx.closePath(); ctx.fill(); ctx.restore();
    }
    function launchConfetti({duration=1200, count=80}={}){
      const particles = [];
      const colors = ['#ff7eb6', '#ff9ecb', '#ffd7e8', '#ffc2e1', '#ffffff'];
      for(let i=0;i<count;i++){
        const shape = Math.random() < 0.55 ? 'heart' : 'star';
        const x = Math.random()*confettiCanvas.width;
        const y = confettiCanvas.height + Math.random()*60;
        const vx = (Math.random()*2-1) * 1.2;
        const vy = - (2.5 + Math.random()*2.5);
        const size = 6 + Math.random()*10;
        const rot = Math.random()*Math.PI;
        const vr = (Math.random()*2-1)*0.08;
        const color = colors[(Math.random()*colors.length)|0];
        particles.push({shape,x,y,vx,vy,size,rot,vr,color,life:duration});
      }

      let last = performance.now();
      function tick(now){
        const dt = now - last; last = now;
        ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
        let alive = 0;
        particles.forEach(p=>{
          p.life -= dt; if(p.life<=0) return;
          alive++;
          p.vy += 0.005*dt;
          p.x += p.vx * dt * 0.06;
          p.y += p.vy * dt * 0.06;
          p.rot += p.vr * dt * 0.06;
          ctx.globalAlpha = Math.max(0, Math.min(1, p.life/duration + 0.2));
          ctx.fillStyle = p.color;
          if(p.shape==='heart'){ drawHeart(p.x, p.y, p.size, p.rot); }
          else { drawStar(p.x, p.y, 5, p.size, p.size*0.5, p.rot); }
        });
        ctx.globalAlpha = 1;
        if(alive>0) requestAnimationFrame(tick);
        else ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
      }
      requestAnimationFrame((t)=>{ last=t; tick(t); });
    }

    // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á chime ‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å
    async function chime(){
      const AC = window.AudioContext || window.webkitAudioContext;
      const ctxA = new AC();
      const o = ctxA.createOscillator();
      const g = ctxA.createGain();
      o.type = 'triangle';
      o.frequency.value = 660; // E5
      g.gain.value = 0.0001;
      o.connect(g).connect(ctxA.destination);
      o.start();
      g.gain.exponentialRampToValueAtTime(0.3, ctxA.currentTime + 0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, ctxA.currentTime + 0.25);
      o.stop(ctxA.currentTime + 0.26);
      setTimeout(()=> ctxA.close(), 350);
    }

    /* === PIN pad logic (‡πÅ‡∏ó‡∏ô‡∏£‡∏∞‡∏ö‡∏ö OTP ‡πÄ‡∏î‡∏¥‡∏°) === */
    const dots = document.querySelectorAll('#pinDots .dot');
    const pad = document.querySelector('.numpad');
    const status = document.getElementById('gateStatus');
    let input = "";

    pad.addEventListener('click',e=>{
      if(e.target.tagName!=="BUTTON") return;
      const gate = document.querySelector('.gate');
      const num = e.target.dataset.num;

      if(num){ // ‡∏Å‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
        if(input.length<4){
          input += num;
          dots[input.length-1].classList.add('filled');
        }
      }else if(e.target.classList.contains('clear')){ // ‡∏•‡∏ö‡∏ï‡∏±‡∏ß‡∏ó‡πâ‡∏≤‡∏¢
        if(input.length>0){
          dots[input.length-1].classList.remove('filled');
          input = input.slice(0,-1);
        }
      }else if(e.target.classList.contains('enter')){ // ‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏´‡∏±‡∏™
        if(input===CONFIG.CODE){
          status.textContent="Unlocked!"; status.className="status ok";
          chime(); launchConfetti({duration:1500,count:100});
          if(CONFIG.REDIRECT){ setTimeout(()=>{ location.href = CONFIG.NEXT_URL; }, 1200); }
        }else{
          status.textContent="Wrong code üí≠"; status.className="status err";
          gate.classList.add('shake'); setTimeout(()=>gate.classList.remove('shake'), 400);
          if(navigator.vibrate) navigator.vibrate(120);
          input=""; dots.forEach(d=>d.classList.remove('filled'));
        }
      }
    });

    /* Slider center active */
    const slider=document.getElementById('photoSlider');
    const slides=Array.from(slider.querySelectorAll('.slide'));
    function updateActive(){
      let min=Infinity, active=null;
      slides.forEach(sl=>{
        const box=sl.getBoundingClientRect();
        const center=box.left+box.width/2;
        const diff=Math.abs(center-window.innerWidth/2);
        if(diff<min){min=diff;active=sl;}
      });
      slides.forEach(sl=>sl.classList.remove('active'));
      if(active)active.classList.add('active');
    }
    slider.addEventListener('scroll',()=>requestAnimationFrame(updateActive));
    window.addEventListener('resize',updateActive);
    updateActive();
  </script>
</body>
</html>
